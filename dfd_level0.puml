!procedure startDfd($title)
digraph dfd2 {
rankdir="LR"
node[shape=record]
!endprocedure

!procedure endDfd()
}
!endprocedure

!procedure External($alias, $label)
    $alias [label="$label" shape=box fillcolor=lightblue style=filled fontcolor=black fontsize=12 color=black width=2];
!endprocedure

!procedure Process($alias, $id, $name)
    $alias [label="$id | $name\n\n" shape=Mrecord fillcolor=white style=filled fontcolor=black fontsize=12];
!endprocedure

!procedure Store($alias, $id, $name)
    $alias [label="<f0> $id   |<f1> $name"];
!endprocedure

!procedure Flow($from, $to, $label = "")
    !if ($label != "")
         $from -> $to [ label="$label"];
    !else
         $from -> $to [ constraint=false];
    !endif
!endprocedure

' External entity to Process (incoming from external)
!procedure ExtToProc($ext, $proc, $label = "")
    Flow($ext, $proc, $label);
!endprocedure

' Process to External entity (outgoing from process)
!procedure ProcToExt($proc, $ext, $label = "")
    Flow($proc, $ext, $label);
!endprocedure

' Process to Process
!procedure ProcToProc($proc1, $proc2, $label = "")
    Flow($proc1, $proc2, $label);
!endprocedure

' Process to Data Store (outgoing from process to datastore)
!procedure ProcToStore($proc, $store, $label = "")
    Flow($proc, $store, $label);
!endprocedure

' Data Store to Process (incoming to process from datastore)
!procedure StoreToProc($store, $proc, $label = "")
    Flow($store, $proc, $label);
!endprocedure

!procedure startProcessCluster()
subgraph cluster_processes {
    label="Processes";
    rankdir=TB;
!endprocedure

!procedure endProcessCluster()
}
!endprocedure

!procedure startStoreCluster()
subgraph cluster_stores {
    label="Data Stores";
    rankdir=TB;
!endprocedure

!procedure endStoreCluster()
}
!endprocedure
