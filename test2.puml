!includeurl https://raw.githubusercontent.com/ArmanAvanesyan/test/main/DFD.puml

' Base Element Functions
!function $formatLabel($shape, $label)
  !$formattedLabel = ""

  !if ($shape == "Mrecord")
    !$formattedLabel = "0 | " + $label + "\n\n"
  !else
    !$formattedLabel = $label
  !endif

  !return $formattedLabel
!endfunction

!function $constructElementLine($alias, $formattedLabel, $shape)
  !$line = $alias + " [label=" + %chr(34) + $formattedLabel + %chr(34) + ", shape=" + $shape + "]"
  !return $line
!endfunction

!function $getElementLine($shape, $alias, $label)
  !$formattedLabel = $formatLabel($shape, $label)  ' Get formatted label
  !$line = $constructElementLine($alias, $formattedLabel, $shape) 
  !return $line
!endfunction

' Start & End of DFD

!procedure startDfd()
digraph dfd2 {
    rankdir="LR"
    node[shape=record]
!endprocedure

!procedure endDfd()
}
!endprocedure

' Element Constructors

' External Entity Constructor
!unquoted procedure External($alias, $label)
  $getElementLine("box", $alias, $label)
!endprocedure

' Process Constructor
!unquoted procedure Process($alias, $label)
  $getElementLine("Mrecord", $alias, $label)
!endprocedure

@enduml
