!includeurl https://raw.githubusercontent.com/ArmanAvanesyan/test/main/DFD.puml

' Base Element Function
!function $getBaseElement($label, $id,  $shape)
  !$element = ""

  ' Add Label (Name)
  !if ($label != "")
    !if ($element != "")
      !$element = !$element + " |<f1> " + $label
    !else
      !$element = "<f1> " + $label
    !endif
  !endif

  ' Add ID
  !if ($id != "")
    !$element = "<f0> " + $id
  !endif

  ' If shape is "Mrecord", wrap in {}
  !if ($shape == "Mrecord")
    !$element = "{ " + !$element + " }"
  !endif

  !return $element
!endfunction

' Start & End of DFD

!procedure startDfd()
digraph dfd2 {
    rankdir="LR"
    node[shape=record]
!endprocedure

!procedure endDfd()
}
!endprocedure

' Element Constructors

' External Entity Constructor
!procedure External($alias, $label)
  !$element = $getBaseElement($label, "box")
  $alias [label="$element", shape=box];
!endprocedure

' Process Constructor
!procedure Process($alias, $label)
  !$element = $getBaseElement($label, "Mrecord")
  $alias [label="$element", shape=Mrecord];
!endprocedure
@enduml
