' DFD Level 0 â€“ Context Diagram
' Purpose: Show system as a black box with external entities
' Rules: Only ONE process, external entities allowed, NO data stores

!include https://raw.githubusercontent.com/ArmanAvanesyan/test/main/DFD.puml

' Profile selectors
!procedure DFD_PROFILE_LEVEL_0()
  !global $__DFD_LEVEL = 0
  !global $__DFD_ALLOW_DATASTORE = 0
  !global $__DFD_ALLOW_SUBPROCESS = 0
  !global $__DFD_ALLOW_MULTI_PROCESS = 0
  !$__dfd_process_count = 0
  !global $LEVEL = "Context Diagram"
!endprocedure


' Level 0 Profile Configuration
!procedure DFD_INIT()
  DFD_INIT_BASE()
  DFD_PROFILE_LEVEL_0()


 ' Default styles and settings for Context Level 0
!$DEFAULT_TITLE_FONTSIZE = 16
!$DEFAULT_SUBTITLE_FONTSIZE = 10
!$LEVEL = "Context Level 0"

!$STYLE = $DEFAULT_STYLE
!$FILLCOLOR = $DEFAULT_FILLCOLOR
!$FONTCOLOR = $DEFAULT_FONTCOLOR
!$FONTSIZE = $DEFAULT_FONTSIZE
!$BORDERCOLOR = $DEFAULT_BORDERCOLOR
!$WIDTH = $DEFAULT_WIDTH
!$HEIGHT = $DEFAULT_HEIGHT

!$EXTERNAL_STYLE = $DEFAULT_EXTERNAL_STYLE
!$EXTERNAL_FILLCOLOR = $DEFAULT_EXTERNAL_FILLCOLOR
!$EXTERNAL_SHAPE = $DEFAULT_EXTERNAL_SHAPE
!$EXTERNAL_WIDTH = $DEFAULT_EXTERNAL_WIDTH
!$EXTERNAL_HEIGHT = $DEFAULT_EXTERNAL_HEIGHT

!$PROCESS_STYLE = $DEFAULT_PROCESS_STYLE
!$PROCESS_FILLCOLOR = $DEFAULT_PROCESS_FILLCOLOR
!$PROCESS_SHAPE = $DEFAULT_PROCESS_SHAPE
!$PROCESS_WIDTH = $DEFAULT_PROCESS_WIDTH
!$PROCESS_HEIGHT = $DEFAULT_PROCESS_HEIGHT

!$ARROW_STYLE = $DEFAULT_ARROW_STYLE
!$ARROW_COLOR = $DEFAULT_ARROW_COLOR
!$ARROW_FONTCOLOR = $DEFAULT_ARROW_FONTCOLOR
!$ARROW_FONTSIZE = $DEFAULT_ARROW_FONTSIZE
!$PENWIDTH = $DEFAULT_PENWIDTH

!$LAYOUT_ENGINE = $DEFAULT_LAYOUT_ENGINE
!$RANKDIR = $DEFAULT_RANKDIR
!$RANKSEP = $DEFAULT_RANKSEP
!$NODESEP = $DEFAULT_NODESEP
!$SPLINES = $DEFAULT_SPLINES
!$CONCENTRATE = $DEFAULT_CONCENTRATE
!$CONSTRAINT = $DEFAULT_CONSTRAINT

' Initialize default styles
SetAllComponentColors("lightsteelblue1")
SetAllComponentSizes(2, 1)
SetAllComponentStyles("filled")
SetAllFlowProperties("solid", "black", "black", 13, 1)
SetFlowLayoutOrthogonal()

' External Entity (Level 0 override - uses style variables)
!unquoted procedure External($alias, $label, $id="")
  Component($alias, $label, $id, $EXTERNAL_SHAPE, $EXTERNAL_FILLCOLOR, $EXTERNAL_WIDTH, $EXTERNAL_HEIGHT, "external")
!endprocedure

' Process (Level 0 override - enforces single process rule)
!unquoted procedure Process($alias, $label, $id="")
  ' Level 0 validation: only one process allowed
  !if $__dfd_process_count > 0
    !error "DFD Level 0 allows only one process"
  !endif
  !$__dfd_process_count = $__dfd_process_count + 1
  Component($alias, $label, $id, $PROCESS_SHAPE, $PROCESS_FILLCOLOR, $PROCESS_WIDTH, $PROCESS_HEIGHT, "process")
!endprocedure

' Data Store (Level 0 override - should error)
!unquoted procedure DataStore($alias, $label, $id="")
  !error "Data stores are not allowed in DFD Level 0 (Context Diagram)"
!endprocedure
